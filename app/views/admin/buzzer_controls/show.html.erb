<div class="container">
  <section class="section" data-controller="buzzer-control">
    <h1 class="title is-2">早押し機連携</h1>

    <div class="box" data-controller="buzzer-assignment">
      <h2 class="title is-4">ボタン席割り当て設定</h2>
      <div class="is-flex is-justify-content-flex-end mb-3">
        <button type="button" class="button is-light" data-action="click->buzzer-assignment#clearAllMappings">全消去</button>
      </div>
      <table class="table is-fullwidth is-striped">
        <thead>
          <tr>
            <th>席</th>
            <th>割り当て</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <% 0.upto(11) do |seat| %>
            <tr data-buzzer-assignment-seat-row data-seat="<%= seat %>">
              <td>席<%= seat %></td>
              <td data-buzzer-assignment-role="assignment">未割当</td>
              <td>
                <button
                  type="button"
                  class="button is-small"
                  data-seat="<%= seat %>"
                  data-buzzer-assignment-role="learnButton"
                  data-action="click->buzzer-assignment#startLearningSeat"
                >
                  設定
                </button>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

    <div class="box" data-controller="buzzer-serial">
      <h2 class="title is-4">早押し機接続</h2>
      <p class="mb-3">
        接続状態:
        <span class="tag is-warning" data-buzzer-serial-target="status">未接続</span>
      </p>
      <div class="buttons">
        <button
          type="button"
          class="button is-primary"
          data-buzzer-serial-target="connectButton"
          data-action="click->buzzer-serial#connect"
        >
          接続
        </button>
        <button
          type="button"
          class="button is-light"
          data-buzzer-serial-target="disconnectButton"
          data-action="click->buzzer-serial#disconnect"
          disabled
        >
          切断
        </button>
      </div>
    </div>

    <div class="box" data-controller="buzzer-emulator">
      <h2 class="title is-4">早押し機エミュレータ</h2>
      <p class="mb-3">
        最終押下ボタン:
        <span class="tag is-info" data-buzzer-emulator-target="lastPressed">未入力</span>
      </p>

      <div class="fixed-grid has-6-cols mb-4">
        <div class="grid">
          <% 1.upto(24) do |button_id| %>
            <div class="cell">
              <button
                type="button"
                class="button is-fullwidth"
                data-button-id="<%= button_id %>"
                data-action="click->buzzer-emulator#pressButton"
              >
                <%= button_id %>
              </button>
            </div>
          <% end %>
        </div>
      </div>

      <button type="button" class="button is-danger" data-action="click->buzzer-emulator#reset">
        reset
      </button>
    </div>
  </section>
</div>
